
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Memory Log</title>
    <link rel="stylesheet" href="{% static 'app/css/dashboard.css' %}">

    <style>
        /* PAGE */
        .page-header {
            margin-bottom: 32px;
        }

        .page-header h2 {
            margin: 0;
            font-size: 26px;
            font-weight: 600;
        }

        .page-subtitle {
            margin-top: 6px;
            font-size: 14px;
            color: #555;
        }

        /* Layout */
        .memory-layout {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }

        /* Cards */
        .card {
            padding: 24px;
            border-radius: 18px;
            background: #fff;
            box-shadow: 0 12px 30px rgba(0,0,0,0.06);
            height: fit-content;
        }

        /* Game Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 120px);
            gap: 15px;
            margin: 20px 0;
        }

        .box {
            width: 120px;
            height: 120px;
            border-radius: 15px;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.2s ease;
        }

        .box:hover {
            opacity: 1;
        }

        .red { background: #f44336; }
        .green { background: #4CAF50; }
        .blue { background: #3F51B5; }
        .yellow { background: #FFC107; }

        .active {
            opacity: 1;
            box-shadow: 0 0 20px rgba(0,0,0,0.4);
        }

        .primary-btn {
            margin-top: 10px;
            padding: 10px 18px;
            border-radius: 10px;
            border: none;
            background: #4f46e5;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
</head>

<body>
<div class="app-container">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <h2 class="logo">ReMindCare</h2>

        <nav class="menu">
            <a href="{% url 'dashboard' %}" class="menu-item">üè† Dashboard</a>
            <a href="{% url 'routine_page' %}" class="menu-item">üìã Routines</a>
            <a href="{% url 'reminder_page' %}" class="menu-item">‚è∞ Reminders</a>
            <a href="{% url 'medication' %}"class="menu-item">üíä Medication</a>
            <a href="{% url 'memory' %}" class="menu-item">üß† Memory Log</a>
            <a href="{% url 'family' %}"class="menu-item">üìû Call Family</a>
            <a href="{% url 'profile' %}" class="menu-item">üë§ Profile</a>
            <a href="{% url 'logout' %}" class="menu-item logout">üö™ Logout</a>
        </nav>
    </aside>
    <!-- MAIN CONTENT -->
    <div class="main-content">
        <p class="breadcrumb">
            &lt;&lt; AI Assistive &nbsp;‚Ä∫&nbsp; Memory Log
        </p>


        <!-- PAGE HEADER -->
        <div class="page-header">
            <h2>Memory Log</h2>
            <p class="page-subtitle">
                Play a sequence memory game to help improve memory.
            </p>
        </div>

        <!-- CONTENT -->
        <div class="memory-layout">

            <!-- GAME CARD -->
            <div class="card">
                <h3>Sequence Memory Game</h3>

                <div class="grid">
                    <div class="box red" data-color="red"></div>
                    <div class="box green" data-color="green"></div>
                    <div class="box blue" data-color="blue"></div>
                    <div class="box yellow" data-color="yellow"></div>
                </div>

                <p><strong>Level:</strong> <span id="level">0</span></p>
                <p><strong>Round:</strong> <span id="round">0</span></p>

                <button onclick="startGame()" class="primary-btn">
                    Start Game
                </button>
            </div>

            <!-- FEEDBACK CARD -->
            <div class="card">
                <h3>Feedback</h3>
                <p id="feedback">Press "Start Game" to begin.</p>
                <hr>
                <strong>Your Latest Score</strong>
                <p id="score">--</p>
                <a href="{% url 'dashboard' %}">‚Üê Back to Dashboard</a>
            </div>

        </div>
    </div>
</div>

<script>
const colors = ["red","green","blue","yellow"];
let sequence = [];
let userSequence = [];
let level = 0;

const boxes = document.querySelectorAll(".box");

boxes.forEach(box => {
    box.addEventListener("click", () => handleUserClick(box.dataset.color));
});

function startGame() {
    sequence = [];
    userSequence = [];
    level = 0;
    nextRound();
}

function nextRound() {
    userSequence = [];
    level++;
    document.getElementById("level").innerText = level;
    document.getElementById("round").innerText = level;
    document.getElementById("feedback").innerText = "Watch the sequence...";

    const randomColor = colors[Math.floor(Math.random() * 4)];
    sequence.push(randomColor);

    playSequence();
}

function playSequence() {
    let i = 0;
    const interval = setInterval(() => {
        flash(sequence[i]);
        i++;
        if (i >= sequence.length) clearInterval(interval);
    }, 600);
}

function flash(color) {
    const box = document.querySelector(`.${color}`);
    box.classList.add("active");
    setTimeout(() => box.classList.remove("active"), 300);
}

function handleUserClick(color) {
    userSequence.push(color);
    flash(color);

    const index = userSequence.length - 1;

    if (userSequence[index] !== sequence[index]) {
        document.getElementById("feedback").innerText = "‚ùå Wrong! Game Over.";
        document.getElementById("score").innerText = level - 1;
        return;
    }

    if (userSequence.length === sequence.length) {
        document.getElementById("feedback").innerText = "‚úÖ Correct! Next round...";
        setTimeout(nextRound, 1000);
    }
}
</script>

</body>
</html>
